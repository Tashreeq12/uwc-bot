<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UWC Bot (Voice Enabled)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; }
    .bar { display:flex; gap:8px; align-items:center; padding:10px; border-bottom:1px solid #eee; }
    #voiceBtn, #stopBtn { border:0; padding:10px 14px; border-radius:8px; cursor:pointer; }
    #voiceBtn { background:#1e88e5; color:#fff; }
    #voiceBtn:disabled { background:#9e9e9e; }
    #stopBtn { background:#f5f5f5; }
    #status { font-size:14px; color:#555; }
    #webchat { height: calc(100vh - 56px); }
  </style>

  <!-- Botpress Webchat Script -->
  <script src="https://cdn.botpress.cloud/webchat/v3.2/inject.js"></script>
  <style>
    #webchat .bpWebchat {
      position: unset;
      width: 100%;
      height: 100%;
      max-height: 100%;
      max-width: 100%;
    }
    #webchat .bpFab {
      display: none;
    }
  </style>
</head>
<body>

<div class="bar">
  <button id="voiceBtn">üé§ Speak</button>
  <button id="stopBtn">‚èπ Stop Voice</button>
  <span id="status"></span>
</div>

<!-- Botpress Chat Container -->
<div id="webchat" style="width: 500px; height: 500px;"></div>

<script>
  window.botpress.on("webchat:ready", () => {
    window.botpress.open();
  });
  window.botpress.init({
    "botId": "aa441515-3c65-48ea-acd1-91044111bed2",
    "configuration": {
      "version": "v2",
      "website": {},
      "email": {},
      "phone": {},
      "termsOfService": {},
      "privacyPolicy": {},
      "color": "#3276EA",
      "variant": "solid",
      "headerVariant": "glass",
      "themeMode": "light",
      "fontFamily": "inter",
      "radius": 4,
      "feedbackEnabled": false,
      "footer": "[‚ö° by Botpress](https://botpress.com/?from=webchat)"
    },
    "clientId": "4122d265-45f6-47ff-ad06-007367e5444b",
    "selector": "#webchat"
  });
</script>

<!-- üé§ Voice Feature -->
<script>
(function ready(cb){
  if(window.botpress){ cb(); } 
  else { setTimeout(() => ready(cb), 100); }
})(function(){
  const statusEl=document.getElementById('status');
  const voiceBtn=document.getElementById('voiceBtn');
  const stopBtn=document.getElementById('stopBtn');

  // Text-to-Speech
  function speak(text){
    window.speechSynthesis.cancel();
    const u=new SpeechSynthesisUtterance(text);
    u.lang='en-US'; 
    u.rate=1.0;
    window.speechSynthesis.speak(u);
  }
  stopBtn.addEventListener('click',()=>window.speechSynthesis.cancel());

  // Speak bot replies
  window.botpress.on('message',(event)=>{
    if(event.payload && event.payload.text){
      speak(event.payload.text);
    }
  });

  // Speech-to-Text
  const Rec=window.SpeechRecognition||window.webkitSpeechRecognition;
  if(!Rec){
    statusEl.textContent='Voice input not supported in this browser. Please use Chrome.';
    voiceBtn.disabled=true;
    return;
  }

  const rec=new Rec();
  rec.lang='en-US';
  rec.interimResults=false;

  voiceBtn.addEventListener('click',()=>{
    window.speechSynthesis.cancel();
    statusEl.textContent='Listening‚Ä¶ (allow mic if asked)';
    voiceBtn.disabled=true;
    rec.start();
  });

  rec.onresult=(e)=>{
    const said=e.results[0][0].transcript;
    statusEl.textContent=`You said: ${said}`;
    window.botpress.sendEvent({type:'text', text: said});
  };
  rec.onerror=()=>{ statusEl.textContent='Mic error. Try again.'; };
  rec.onend=()=>{ voiceBtn.disabled=false; };
});
</script>

</body>
</html>




